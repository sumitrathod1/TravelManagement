import{a as I}from"./chunk-OIJJFQGG.js";import{a as T,b as V}from"./chunk-QTEKGX63.js";import{a as N}from"./chunk-YPOWKBJY.js";import"./chunk-3SHNEIU6.js";import{d as F}from"./chunk-H6HNTYG3.js";import"./chunk-4Q7XPJD5.js";import"./chunk-OOG4BF3R.js";import"./chunk-SBERIC2F.js";import{g as k,j as B}from"./chunk-GGO3Y67A.js";import"./chunk-WEZ5LNJ3.js";import{$b as M,Bb as n,Cb as i,Db as g,Gc as O,Hb as C,Hc as P,Ic as w,Jb as m,Lc as S,Mc as E,Oc as D,Tb as r,Ub as u,Vb as d,Wb as b,Za as o,_a as f,ac as _,bc as x,cc as y,dc as h,ia as v,ob as p,sb as s}from"./chunk-QUTPPCZH.js";var z=c=>({expenses:c});function L(c,t){if(c&1&&(n(0,"div",24)(1,"div",25),g(2,"i",26),i(),n(3,"div",27)(4,"div",28),r(5),i(),n(6,"div",29),r(7),i()(),n(8,"div",30),r(9),x(10,"number"),i()()),c&2){let e=t.$implicit,a=m();o(),s("ngClass",a.getExpenseDisplay(e).iconBg),o(),s("ngClass",a.getExpenseDisplay(e).icon),o(3),b(" ",e.vehicle.vehicleName," No: ",e.vehicle.vehicleNumber," "),o(2),u(e.categoryType),o(),s("ngClass","text-danger"),o(),d(" \u20B9",y(10,7,e.amount)," ")}}function $(c,t){if(c&1&&(n(0,"div",40),r(1),i()),c&2){let e=m().$implicit;s("ngClass",e.statusClass),o(),d(" ",e.status," ")}}function R(c,t){if(c&1&&(n(0,"div",31)(1,"div",32),g(2,"i",26),i(),n(3,"div",33)(4,"div",34),r(5),i(),n(6,"div",35),r(7),n(8,"span",36),r(9),x(10,"date"),i(),n(11,"span",37),r(12),i()()(),n(13,"div",38),p(14,$,2,2,"div",39),i()()),c&2){let e=t.$implicit,a=m();o(),s("ngClass",a.getMaintenanceDisplay(e).iconBg),o(),s("ngClass",a.getMaintenanceDisplay(e).icon),o(3),u(e.maintenanceType),o(2),b(" ",e.vehicle.vehicleName," No: ",e.vehicle.vehicleNumber," "),o(2),u(h(10,8,e.nextduedate,"dd MMM, yyyy")),o(3),d(" (",a.getDaysLeft(e.nextduedate),") "),o(2),s("ngIf",e.status)}}function j(c,t){if(c&1&&(n(0,"div",41)(1,"div",42),g(2,"i",26),i(),n(3,"div",43)(4,"div",44),r(5),n(6,"span"),r(7),i()(),n(8,"div",45),r(9),i(),n(10,"div",35)(11,"span",36),r(12),x(13,"date"),n(14,"span",37),r(15),i()()()(),n(16,"div",46),r(17),i()()),c&2){let e=t.$implicit,a=m();o(),s("ngClass",a.getDocumentStatus(e).iconBg),o(),s("ngClass",a.getDocumentStatus(e).icon),o(3),d(" ",e.title,": "),o(2),d("",e.vehicle==null?null:e.vehicle.vehicleName," "),o(2),u(e.vehicle==null?null:e.vehicle.vehicleNumber),o(3),d(" ",h(13,9,e.expiryDate,"dd MMM, yyyy")," "),o(3),d(" (",a.getDaysLeft(e.expiryDate),") "),o(),s("ngClass",a.getDocumentStatus(e).statusClass),o(),d(" ",a.getDocumentStatus(e).status," ")}}var A=class c{constructor(t,e){this._dilog=t;this._vehicleService=e}vehicleDocuments=[];expenses=[];vehicleMaintenances=[];totlalMaintenanceCost=0;totalExpenseCost=0;get allExpenses(){return this.totalExpenseCost+this.totlalMaintenanceCost}documentForm(){}expexnseForm(){this._dilog.open(T)}maintenanceForm(){this._dilog.open(V)}ngOnInit(){this.loadAllDocuments(),this.loadExpenses(),this.loadMaintenance()}loadAllDocuments(){this._vehicleService.getAllDocuments().subscribe({next:t=>{console.log("Documents fetched successfully:",t),this.vehicleDocuments=Array.isArray(t)?t:[],console.log("Documents loaded:",this.vehicleDocuments)},error:t=>{console.error("Error loading documents:",t)}})}loadExpenses(){this._vehicleService.getAllExpences().subscribe({next:t=>{console.log("Expenses fetched successfully:",t),this.expenses=Array.isArray(t)?t:[],this.totalExpenseCost=this.expenses.reduce((e,a)=>e+(a.amount||0),0),console.log("Total expense cost:",this.totalExpenseCost)},error:t=>{console.error("Error loading expenses:",t)}})}loadMaintenance(){this._vehicleService.getAllMaintenances().subscribe({next:t=>{console.log("Vehicle maintenances fetched successfully:",t),this.vehicleMaintenances=Array.isArray(t)?t:[],this.totlalMaintenanceCost=this.vehicleMaintenances.reduce((e,a)=>e+(a.cost||0),0),console.log("Total maintenance cost:",this.totlalMaintenanceCost)},error:t=>{console.error("Error loading expenses:",t)}})}getExpenseDisplay(t){switch(t.categoryType){case"Accident":return{icon:"bi-car-front-fill",iconBg:"bg-red-light"};case"Repair":return{icon:"bi-gear-fill",iconBg:"bg-blue-light"};case"Fuel":return{icon:"bi-droplet-half",iconBg:"bg-orange-light"};case"DocumentRenew":return{icon:"bi-file-earmark-text",iconBg:"bg-green-light"};default:return{icon:"bi-cash-stack",iconBg:"bg-gray-200"}}}getDocumentStatus(t){let e=this.getDaysLeftNumber(t.expiryDate);return e>30?{status:"Valid",statusClass:"badge-valid",icon:"bi-credit-card-2-front-fill",iconBg:"bg-green-light"}:e<20?{status:"Soon",statusClass:"badge-warning",icon:"bi-shield-exclamation",iconBg:"bg-orange-light"}:{status:"Expired",statusClass:"badge-expired",icon:"bi-award-fill",iconBg:"bg-red-light"}}getStatusByDate(t,e){let a=t[e],l=this.getDaysLeftNumber(a);return isNaN(l)?{status:"Unknown",statusClass:"badge-unknown",icon:"bi-question-circle",iconBg:"bg-gray-200"}:l>30?{status:"Valid",statusClass:"badge-valid",icon:"bi-credit-card-2-front-fill",iconBg:"bg-green-light"}:l<20&&l>=0?{status:"Soon",statusClass:"badge-warning",icon:"bi-shield-exclamation",iconBg:"bg-orange-light"}:{status:"Expired",statusClass:"badge-expired",icon:"bi-award-fill",iconBg:"bg-red-light"}}getDaysLeftNumber(t){if(!t)return NaN;let e=new Date,a=new Date(t);return e.setHours(0,0,0,0),a.setHours(0,0,0,0),Math.ceil((a.getTime()-e.getTime())/(1e3*60*60*24))}getDaysLeft(t){let e=new Date,a=new Date(t);e.setHours(0,0,0,0),a.setHours(0,0,0,0);let l=Math.ceil((a.getTime()-e.getTime())/(1e3*60*60*24));return l>0?`${l} days`:l===0?"Today":`${Math.abs(l)} ecpired`}getMaintenanceDisplay(t){switch(t.maintenanceType){case"oilChange":return{icon:"bi-droplet-half",iconBg:"bg-orange"};case"TireChange":return{icon:"bi-circle-fill",iconBg:"bg-blue"};case"Fuel":return{icon:"bi-fuel-pump",iconBg:"bg-yellow-light"};case"Service":return{icon:"bi-gear-fill",iconBg:"bg-green"};default:return{icon:"bi-gear-fill",iconBg:"bg-green"}}}get top4Documents(){return this.vehicleDocuments.slice(0,4)}get top4Expenses(){return this.expenses.slice(0,4)}get top4Maintenances(){return this.vehicleMaintenances.slice(0,4)}static \u0275fac=function(e){return new(e||c)(f(F),f(N))};static \u0275cmp=v({type:c,selectors:[["app-vehicle-form"]],standalone:!0,features:[M],decls:41,vars:6,consts:[[1,"container","my-4"],[1,"row","g-4"],["routerLink","/vehicle-card",1,"col-6","col-md-3",3,"click"],[1,"card","p-2",2,"min-height","80px"],[1,"card-body","text-center"],[1,"mb-1"],[1,"bi","bi-truck","fs-4","text-success"],[1,"card-title","fw-bold"],[1,"card-text","fw-bold"],["routerLink","/vehicle-statistics",1,"col-6","col-md-3",3,"state"],[1,"bi","bi-check-circle","fs-4","text-success"],[1,"expenses-header"],[1,"title"],["routerLink","/expense-table",1,"view-all"],[1,"expenses-list"],["class","expenses-card",4,"ngFor","ngForOf"],[1,"maintenance-header"],["routerLink","/maintenance-table",1,"view-all"],[1,"maintenance-list"],["class","maintenance-card",4,"ngFor","ngForOf"],[1,"doc-header"],["routerLink","/vehicle-documents",1,"manage-link"],[1,"doc-list"],["class","doc-card",4,"ngFor","ngForOf"],[1,"expenses-card"],[1,"exp-icon",3,"ngClass"],[1,"bi",3,"ngClass"],[1,"exp-info"],[1,"exp-title"],[1,"exp-subtitle"],[1,"exp-amount",3,"ngClass"],[1,"maintenance-card"],[1,"maint-icon",3,"ngClass"],[1,"maint-info"],[1,"maint-title"],[1,"maint-subtitle"],[1,"maint-date"],[1,"text-muted"],[1,"maint-right"],["class","maint-status",3,"ngClass",4,"ngIf"],[1,"maint-status",3,"ngClass"],[1,"doc-card"],[1,"doc-icon",3,"ngClass"],[1,"doc-info"],[1,"doc-title"],[1,"doc-subtitle"],[1,"doc-badge",3,"ngClass"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),C("click",function(){return a.documentForm()}),n(3,"div",3)(4,"div",4)(5,"div",5),g(6,"i",6),i(),n(7,"h3",7),r(8,"Total Vehicles"),i(),n(9,"h4",8),r(10,"4"),i()()()(),n(11,"div",9)(12,"div",3)(13,"div",4)(14,"div",5),g(15,"i",10),i(),n(16,"h3",7),r(17,"Statistics"),i(),n(18,"h4",8),r(19,"18"),i()()()()(),n(20,"div",11)(21,"span",12),r(22,"Recent Expenses"),i(),n(23,"a",13),r(24,"View All"),i()(),n(25,"div",14),p(26,L,11,9,"div",15),i(),n(27,"div",16)(28,"span",12),r(29,"Maintenance Schedule"),i(),n(30,"a",17),r(31,"View All"),i()(),n(32,"div",18),p(33,R,15,11,"div",19),i(),n(34,"div",20)(35,"span",12),r(36,"Document Status"),i(),n(37,"a",21),r(38,"Manage"),i()(),n(39,"div",22),p(40,j,18,12,"div",23),i()()),e&2&&(o(11),s("state",_(4,z,a.allExpenses)),o(15),s("ngForOf",a.top4Expenses),o(7),s("ngForOf",a.top4Maintenances),o(7),s("ngForOf",a.top4Documents))},dependencies:[D,O,P,w,E,S,I,B,k],styles:["body[_ngcontent-%COMP%]{background:linear-gradient(120deg,#f7fafb 78%,#e0e7ff);font-family:Inter,Segoe UI,Poppins,Arial,sans-serif}.container[_ngcontent-%COMP%]{max-width:430px;margin:32px auto;padding:18px 8px;background:#fff;border-radius:24px;box-shadow:0 8px 32px #6366f114}.card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 2px 14px #a5b4fc44,0 1.5px 6px #dbeafe77;border:1.6px solid #e0e7ff;padding:19px 10px 14px;display:flex;flex-direction:column;align-items:center;transition:box-shadow .17s,border-color .18s;cursor:pointer}.card[_ngcontent-%COMP%]:hover{border-color:#6366f1;box-shadow:0 12px 36px #6366f122}.card-body[_ngcontent-%COMP%]   .bi[_ngcontent-%COMP%]{font-size:1.8rem;margin-bottom:8px;color:#2563eb!important}.card-title[_ngcontent-%COMP%]{font-size:1.09rem;color:#222;font-weight:600;margin-bottom:4px}.card-text[_ngcontent-%COMP%]{font-size:1.4rem;color:#2563eb;font-weight:700}.expenses-header[_ngcontent-%COMP%], .maintenance-header[_ngcontent-%COMP%], .doc-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:22px 0 8px}.title[_ngcontent-%COMP%]{font-size:1.14rem;font-weight:700;color:#222}.view-all[_ngcontent-%COMP%], .manage-link[_ngcontent-%COMP%]{color:#3b82f6;font-size:1rem;font-weight:500;cursor:pointer;text-decoration:none}.expenses-list[_ngcontent-%COMP%], .maintenance-list[_ngcontent-%COMP%], .doc-list[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 1.5px 6px #dbeafe77;padding:7px 3px;margin-bottom:12px}.expenses-card[_ngcontent-%COMP%], .maintenance-card[_ngcontent-%COMP%], .doc-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:14px 18px;border-radius:13px;margin-bottom:10px;background:#fff;box-shadow:0 2px 8px #6366f10a;border-left:4px solid var(--card-accent, #e0e7ff);animation:_ngcontent-%COMP%_fadeUp .25s cubic-bezier(.17,.67,.83,.67);transition:box-shadow .16s,border-left-color .17s}.expenses-card[_ngcontent-%COMP%]{--card-accent: #ef4444}.maintenance-card[_ngcontent-%COMP%]{--card-accent: #22c55e}.doc-card[_ngcontent-%COMP%]{--card-accent: #fbbf24}.expenses-card[_ngcontent-%COMP%]:hover, .maintenance-card[_ngcontent-%COMP%]:hover, .doc-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 18px #6366f133;border-left-color:#6366f1}@keyframes _ngcontent-%COMP%_fadeUp{0%{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}.exp-icon[_ngcontent-%COMP%], .maint-icon[_ngcontent-%COMP%], .doc-icon[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:50%;background:linear-gradient(120deg,#e0e7ff 60%,#fff);display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:0 0 5px #dbeafe44}.bg-red-light[_ngcontent-%COMP%]{color:#ef4444;background:#fee2e2}.bg-blue-light[_ngcontent-%COMP%]{color:#2563eb;background:#e0e7ff}.bg-green[_ngcontent-%COMP%]{color:#22c55e;background:#e0fce6}.bg-orange-light[_ngcontent-%COMP%]{color:#fbbf24;background:#fef9c3}.exp-title[_ngcontent-%COMP%], .maint-title[_ngcontent-%COMP%], .doc-title[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:700;color:#222}.exp-subtitle[_ngcontent-%COMP%], .maint-subtitle[_ngcontent-%COMP%], .doc-subtitle[_ngcontent-%COMP%]{font-size:.97rem;color:#6b7280;display:flex;flex-wrap:wrap;gap:6px}.maint-date[_ngcontent-%COMP%]{color:#6366f1;font-size:.99rem;margin-left:7px}.text-muted[_ngcontent-%COMP%]{color:#888!important;font-size:.96rem;margin-left:2px}.exp-amount[_ngcontent-%COMP%]{font-size:1.17rem;font-weight:700;color:#ef4444;min-width:80px;text-align:right}.maint-right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:2px;min-width:70px}.maint-status[_ngcontent-%COMP%]{font-size:.98rem;font-weight:600}.maint-status.overdue[_ngcontent-%COMP%]{color:#ef4444}.maint-status.due[_ngcontent-%COMP%]{color:#eab308}.maint-status.complete[_ngcontent-%COMP%]{color:#22c55e}.doc-badge[_ngcontent-%COMP%]{padding:4px 16px;border-radius:12px;font-size:.97rem;font-weight:600;white-space:nowrap;box-shadow:0 1px 6px #f59e4282;margin-left:auto}.badge-valid[_ngcontent-%COMP%]{background:#e0fce6;color:#22c55e}.badge-warning[_ngcontent-%COMP%], .badge-soon[_ngcontent-%COMP%]{background:#fef9c3;color:#eab308}.badge-expired[_ngcontent-%COMP%]{background:#fee2e2;color:#ef4444}@media (max-width: 600px){.container[_ngcontent-%COMP%]{max-width:100vw!important;width:100vw!important;min-width:100vw!important;margin:0!important;padding-left:0!important;padding-right:0!important;border-radius:0!important;box-shadow:none!important}body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{width:100vw!important;min-width:100vw!important;margin:0!important;padding:0!important;overflow-x:hidden!important}.card[_ngcontent-%COMP%], .expenses-card[_ngcontent-%COMP%], .maintenance-card[_ngcontent-%COMP%], .doc-card[_ngcontent-%COMP%]{border-radius:9px;padding:11px 6px}}"]})};export{A as VehicleComponent};
